package rosalind

import org.scalatest.FunSuite
import rosalind.CONV._
import scala.collection.mutable.Stack
 
class CONVTestSuite extends FunSuite {
	def getMultiSet(d: String):MultiSet[BigDecimal] =
	  d.split(" ") map (a => BigDecimal.apply(a))
  
  test("spectral convolution with data from problem") {
    val multiSet1 = getMultiSet("186.07931 287.12699 548.20532 580.18077 681.22845 706.27446 782.27613 968.35544 968.35544")
	val multiSet2 = getMultiSet("101.04768 158.06914 202.09536 318.09979 419.14747 463.17369")    
	val diff = minkowskiDifferenceMap(multiSet1, multiSet2)
	expect((BigDecimal.apply("85.03163"), 3)) { diff.maxBy(item => item._2) }
  }

  test("spectral convolution with real data set") {
    val multiSet1 = getMultiSet("128.09496 244.12455 314.17427 347.13374 486.22267 533.21305 620.24508 677.26654 1160.49944 1219.59856 1273.5835 1356.65747 1401.67846 1472.71557 1791.88048 1928.93939 1990.95794 2028.0078 2128.01685 2244.08242 2341.13518 2445.13665 2454.21924 2638.34041 2661.2299 2808.44593 3049.4257 3052.51546 3106.44716 3295.60098 3480.68102 3611.72151 3767.7763 3914.84471 4029.87165 4048.98531 4143.91458 4186.04422 4402.13747 4493.05722 4503.18515 4606.14128 4719.22534 4820.30495 5175.51566 5266.43541 5361.59497 5369.4446 5482.52866 5619.58757 5753.72817 5846.71455 6347.99398 6372.9719 6461.07804 6619.14718 6706.17921 6745.10001 6860.12695 6894.25892 6973.21101 7007.34298 7101.26958 7214.35364 7424.49046 7511.52249 7640.56508 7677.61494 8195.85731 8240.8783 8266.89442 8311.91541 8605.1262 8775.23172 8890.25866 8991.30634 9069.26615 9354.39861 9540.47792 9555.48882 9668.57288 9668.57288")
	val multiSet2 = getMultiSet("57.02146 131.04049 381.18346 662.30239 790.39735 972.42108 998.49337 1085.50514 1111.57743 1301.59839 1402.64607 1489.6781 1576.71013 1814.88121 1950.87252 2025.01803 2266.16066 2295.06073 2442.12914 2557.15608 2671.19901 2834.26234 2866.39977 3020.34165 3182.5203 3279.57306 3520.71569 3561.63167 3793.71984 3869.92707 3896.72903 4009.81309 4073.98394 4146.872 4205.02443 4245.94041 4391.10374 4487.08304 4584.1358 4633.23039 4715.17629 4900.25633 4932.39376 5095.45709 5143.34185 5209.50002 5471.59537 5500.49544 5584.67943 5741.63807 5918.79277 6189.94597 6266.91792 6655.07867 6681.15096 6768.16273 6839.19984 6925.27551 7218.39664 7385.47264 7433.48725 7709.63464 7766.6561")    
	val diff = minkowskiDifferenceMap(multiSet1, multiSet2)
	expect((BigDecimal.apply("1472.71557"), 16)) { diff.maxBy(item => item._2) }
  }
}